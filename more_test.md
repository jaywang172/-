# 關於碳化硅外延層厚度確定的數學建模與算法分析報告

## 摘要

本報告針對紅外干涉法測量碳化硅（SiC）外延層厚度的問題，建立了一套從理論建模到數據處理的完整分析流程。首先，基於薄膜干涉原理，我們推導了描述光程差（OPD）與外延層厚度 $d$、折射率 $n_1$ 及入射角 $\theta$ 之間關係的**二光束干涉模型**。其次，針對模型中 $n_1$ 未知且存在色散的問題，我們設計了一種基於**快速傅立葉變換（FFT）**的穩健算法，該算法能直接從光譜數據中提取OPD。在處理SiC樣品數據（附件1、2）時，我們識別並排除了材料本徵吸收帶（Reststrahlen band）的干擾，並通過對比雙角度測量結果，論證了在高折射率材料中應採用**引入先驗知識**的策略。最終確定SiC外延層厚度為 **$d = 7.73 \pm 0.01 \, \mu\text{m}$**。最後，通過分析硅樣品（附件3、4）的OPD譜諧波成分，我們確證了**多光束干涉**的存在性，並闡述了其對測量精度的影響及相應的建模策略（Airy模型）。本報告所提方法具有高精度和強魯棒性，為半導體薄膜的無損檢測提供了可靠的解決方案。

---

## 問題一：二光束干涉模型的建立

### 1.1 物理情景分析

紅外光入射到外延層表面時，發生反射和折射。如圖1所示，`反射光1`由空氣-外延層界面直接反射形成；`反射光2`由入射光折射進入外延層，經外延層-襯底界面反射後，再次折射回空氣中形成。這兩束光因傳播路徑不同而產生光程差，從而發生干涉。

### 1.2 數學推導

**1. 基本參數定義：**
* $d$: 外延層厚度。
* $\theta_i$: 空氣中的入射角。
* $\theta_r$: 外延層中的折射角。
* $n_0$: 空氣折射率，設 $n_0 = 1$。
* $n_1$: 外延層折射率。
* $\lambda$: 真空中的波長；$\tilde{\nu} = 1/\lambda$: 波数。

**2. 斯涅爾定律 (Snell's Law)：**
光線在空氣-外延層界面的折射遵循斯涅爾定律：

$$
n_0 \sin \theta_i = n_1 \sin \theta_r \implies \sin \theta_r = \frac{\sin \theta_i}{n_1}
$$

**3. 光程差 (Optical Path Difference, OPD) 計算：**
`反射光2`相較於`反射光1`增加的光程主要發生在外延層內部。其幾何光程差 $\text{OPD}_{\text{geom}}$ 為：

$$
\text{OPD}_{\text{geom}} = 2 n_1 d \cos \theta_r
$$

利用 $\cos \theta_r = \sqrt{1 - \sin^2 \theta_r} = \sqrt{1 - (\sin \theta_i / n_1)^2}$，可得：

$$
\text{OPD}_{\text{geom}} = 2 d \sqrt{n_1^2 - \sin^2 \theta_i}
$$

**4. 相位突變分析：**
光的反射可能伴隨相位突變。當光從光疏介質射向光密介質時，反射光有 $\pi$ 相位突變（相當於 $\lambda/2$ 光程）。
* **界面1 (空氣-外延層)：** $n_1 > n_0$ (SiC折射率約2.6 > 空氣1)，發生 $\pi$ 相位突變。
* **界面2 (外延層-襯底)：** 襯底通常為重摻雜SiC，其載流子效應會使其在紅外波段的折射率 $n_2$ 低於輕摻雜的外延層 $n_1$。因此假設 $n_1 > n_2$，反射時**無**相位突變。

兩束光之間存在一次淨的 $\pi$ 相位突變。值得注意的是，即使 $n_1 \le n_2$ 的假設成立（即界面2也發生$\pi$相位突變），總的淨相位差將變為0或$2\pi$。這僅會將相長與相消干涉的條件互換。然而，由於我們後續採用的傅立葉變換算法是對信號的**振盪頻率**進行分析，而非依賴於極值的絕對位置，因此**該算法的結果對於相位突變的假設是穩健的**。

**5. 干涉條件方程：**
* **相消干涉（反射率極小值）：** 總光程差為波長的整數倍 $m\lambda$。

$$
\text{OPD}_{\text{geom}} + \frac{\lambda}{2} = m\lambda \implies \text{OPD}_{\text{geom}} = (m - \frac{1}{2})\lambda
$$

* **相長干涉（反射率極大值）：** 總光程差為半波長的奇數倍 $(m+1/2)\lambda$。

$$
\text{OPD}_{\text{geom}} + \frac{\lambda}{2} = (m + \frac{1}{2})\lambda \implies \text{OPD}_{\text{geom}} = m\lambda
$$

### 1.3 最終模型

將 $\text{OPD}_{\text{geom}}$ 代入相長干涉條件（對應反射光譜的峰值），得到用於厚度計算的基本模型：

$$
2d \sqrt{n_1(\tilde{\nu})^2 - \sin^2 \theta_i} = \frac{m}{\tilde{\nu}_{\max}}
$$

其中 $m$ 為干涉級數（正整數），$n_1(\tilde{\nu})$ 表示折射率隨波数變化的色散關係。此模型構成了後續算法設計的基礎。

---

## 問題二：SiC外延層厚度算法設計、計算與可靠性分析

### 2.1 算法設計：傅立葉變換法

直接求解模型(1.3)面臨兩大挑戰：(1) 干涉級數 $m$ 未知；(2) 折射率 $n_1(\tilde{\nu})$ 是未知的複雜函數。

我們採用**傅立葉變換法**規避這些問題。干涉信號 $R(\tilde{\nu})$ 在波数域的振盪可以視為一個調頻信號，其「瞬時頻率」與OPD相關。對 $R(\tilde{\nu})$ 進行傅立葉變換，可以將其變換到共軛域——光程差域。在OPD譜上，干涉信號將在 $\tilde{\nu}_{\text{center}}$ 對應的平均光程差 $\text{OPD}_{\text{avg}}$ 處形成一個清晰的峰值。

**算法步驟：**
1. **數據加載與預處理：** 讀取光譜數據 $(\tilde{\nu}, R(\tilde{\nu}))$。
2. **數據篩選：** 識別並排除物理模型不適用的區域（如材料本徵吸收帶）。
3. **插值：** 將非均勻採樣的波数數據通過線性插值轉換為均勻網格，以滿足FFT算法要求。
4. **基線校正：** 採用**Savitzky-Golay濾波器**擬合光譜的低頻背景趨勢。該背景主要由儀器響應函數和材料的宏觀光學特性貢獻，其移除是為了分離出高頻的干涉信息。
5. **加窗與FFT：** 對提取出的干涉信號應用**Hanning窗函數**，以**抑制因數據截斷而產生的頻譜洩漏(spectral leakage)**，確保OPD譜峰的準確性和信噪比。隨後執行FFT計算功率譜。
6. **峰值提取：** 在OPD功率譜上定位最強峰的位置，即為平均光程差 $\text{OPD}_{\text{avg}}$。

### 2.2 數據分析與結果

**1. SiC樣品（附件1、2）初步分析與模型精煉：**
* **現象識別：** SiC光譜在 750-1000 cm⁻¹ 範圍內存在強烈的Reststrahlen吸收帶。此區域的光學響應由晶格振動主導，不符合透明薄膜干涉模型。
* **策略調整：** 為保證模型有效性，我們**將分析範圍限制在 1200 cm⁻¹ 至 4000 cm⁻¹** 的透明區。

**2. 雙角度測量分析：**
* **數據獲取：** 對附件1（$\theta_i=10^\circ$）和附件2（$\theta_i=15^\circ$）的篩選後數據執行FFT算法，得到光程差：
  * OPD$_{10^\circ}$ = 39.7371, $\mu$m
  * OPD$_{15^\circ}$ = 39.7371, $\mu$m
* **方法局限性論證：** 兩個角度下的OPD值在數值精度內完全相同。這是因為SiC的折射率 $n_1 \approx 2.6$ 遠大於 $\sin(15^\circ) \approx 0.26$，導致 $\sqrt{n_1^2 - \sin^2 \theta_i}$ 項對 $\theta_i$ 的變化極不敏感。因此，試圖聯立求解 $d$ 和 $n_1$ 的方法在此失效。

**3. 引入先驗知識求解：**
* **為解決上述問題**，我們引入物理先驗知識。根據學術文獻（例如，S. Adachi, "Optical Constants of Crystalline and Amorphous Semiconductors"），4H-SiC晶體在该紅外波段的折射率 $n_1$ 約為**2.58**。我們以此作為計算中的有效折射率。
* **厚度計算：** 公式如下：

$$
d = \frac{\text{OPD}}{2\sqrt{n_1^2 - \sin^2 \theta_i}}
$$

使用 $\theta_i=10^\circ$ 數據：$d = 39.7371 / (2\sqrt{2.58^2 - \sin^2(10^\circ)}) = 7.719 \, \mu\text{m}$。

使用 $\theta_i=15^\circ$ 數據：$d = 39.7371 / (2\sqrt{2.58^2 - \sin^2(15^\circ)}) = 7.740 \, \mu\text{m}$。

### 2.3 可靠性分析與結論
